require=function e(t,n,i){function s(a,c){if(!n[a]){if(!t[a]){var r="function"==typeof require&&require;if(!c&&r)return r(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return s(n?n:e)},l,l.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)s(i[a]);return s}({AudioMng:[function(e,t,n){"use strict";cc._RFpush(t,"46bf8MJ+ylG6L5OVxzUo6vg","AudioMng"),cc.Class({"extends":cc.Component,properties:{winAudio:{"default":null,url:cc.AudioClip},loseAudio:{"default":null,url:cc.AudioClip},cardAudio:{"default":null,url:cc.AudioClip},buttonAudio:{"default":null,url:cc.AudioClip},chipsAudio:{"default":null,url:cc.AudioClip},bgm:{"default":null,url:cc.AudioClip}},playMusic:function(){cc.audioEngine.playMusic(this.bgm,!0)},pauseMusic:function(){cc.audioEngine.pauseMusic()},resumeMusic:function(){cc.audioEngine.resumeMusic()},_playSFX:function(e){cc.audioEngine.playEffect(e,!1)},playButton:function(){this._playSFX(this.buttonAudio)}}),cc._RFpop()},{}],ButtonScaler:[function(e,t,n){"use strict";cc._RFpush(t,"5c156RZ5+lJ4It6heya76Cw","ButtonScaler"),cc.Class({"extends":cc.Component,properties:{pressedScale:1,transDuration:0},onLoad:function(){function e(e){this.stopAllActions(),i&&i.playButton(),this.runAction(n.scaleDownAction)}function t(e){this.stopAllActions(),this.runAction(n.scaleUpAction)}var n=this,i=AudioMng();n.initScale=this.node.scale,n.button=n.getComponent(cc.Button),n.scaleDownAction=cc.scaleTo(n.transDuration,n.pressedScale),n.scaleUpAction=cc.scaleTo(n.transDuration,n.initScale),this.node.on("touchstart",e,this.node),this.node.on("touchend",t,this.node),this.node.on("touchcancel",t,this.node)}}),cc._RFpop()},{}],buyItemsHandler:[function(e,t,n){"use strict";cc._RFpush(t,"c49f0AZwPBMHpfqVQ9qFWIM","buyItemsHandler");var i=e("msgHandler"),s={};s.interest="buyItemsSuccess",s.Process=function(e){GameEvent().SendEvent("BuyItemsSuccess"),GameNotify().AddText("购买成功!")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],buyProperty:[function(e,t,n){"use strict";cc._RFpush(t,"77e9324BmFCb5KLA71q3gE2","buyProperty"),cc.Class({"extends":cc.Component,properties:{addBtn:cc.Button,subBtn:cc.Button,buyBtn:cc.Button,cancelBtn:cc.Button,propName:cc.Label,propType:cc.Label,describe:cc.Label,buyNumber:cc.Label,amountPrice:cc.Label,limitLevel:cc.Label},onLoad:function(){this.addBtn.node.on("click",this.OnAdd,this),this.subBtn.node.on("click",this.OnSub,this),this.buyBtn.node.on("click",this.OnBuy,this),this.cancelBtn.node.on("click",function(e){this.OnHide()}.bind(this))},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1},OnAdd:function(e){this.buyCount+=1,this.buyCount<=0&&(this.buyCount=1),this.buyNumber.string=this.buyCount,this.amountPrice.string=this.buyCount*this.buyPrice+"金币",this.buyCount>1&&(this.subBtn.interactable=!0)},OnSub:function(e){this.buyCount-=1,this.buyCount<=0&&(this.buyCount=1,this.subBtn.interactable=!1),this.buyNumber.string=this.buyCount,this.amountPrice.string=this.buyCount*this.buyPrice+"金币"},OnBuy:function(e){var t=window.GameData;if(t.GetMoney()<this.buyCount*this.buyPrice){var n=Table.GetEntry("error",6);return void(n?GameNotify().AddText(n.description,window.ErrorNotifyColor):GameNotify().AddText("金币不足!",window.ErrorNotifyColor))}var i={type:"buyItems",kinds:1,buyId:this.buyId,buyCount:this.buyCount},s=JSON.stringify(i);GameSocket().Send(s),this.OnHide()},Setup:function(e){this.propName.string=e.name,this.describe.string=e.desc,this.buyId=e.id,this.buyPrice=e.buy,this.buyCount=0,this.limitLevel.node.active=!1,this.OnAdd(null)}}),cc._RFpop()},{}],buySeed:[function(e,t,n){"use strict";cc._RFpush(t,"ad48686xkROraOi6t5jt9WJ","buySeed"),cc.Class({"extends":cc.Component,properties:{addBtn:cc.Button,subBtn:cc.Button,buyBtn:cc.Button,cancelBtn:cc.Button,buyNumber:cc.Label,seedName:cc.Label,time:cc.Label,output:cc.Label,price:cc.Label,gains:cc.Label,getExp:cc.Label,amountPrice:cc.Label,limitLevel:cc.Label},onLoad:function(){this.addBtn.node.on("click",this.OnAdd,this),this.subBtn.node.on("click",this.OnSub,this),this.buyBtn.node.on("click",this.OnBuy,this),this.cancelBtn.node.on("click",function(e){this.OnHide()}.bind(this))},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1},OnAdd:function(e){this.buyCount+=1,this.buyCount<=0&&(this.buyCount=1),this.buyNumber.string=this.buyCount,this.amountPrice.string=this.buyCount*this.buyPrice+"金币",this.buyCount>1&&(this.subBtn.interactable=!0)},OnSub:function(e){this.buyCount-=1,this.buyCount<=0&&(this.buyCount=1,this.subBtn.interactable=!1),this.buyNumber.string=this.buyCount,this.amountPrice.string=this.buyCount*this.buyPrice+"金币"},OnBuy:function(e){var t=window.GameData;if(t.GetMoney()<this.buyCount*this.buyPrice){var n=Table.GetEntry("error",6);return void(n?GameNotify().AddText(n.description,window.ErrorNotifyColor):GameNotify().AddText("金币不足!",window.ErrorNotifyColor))}var i={type:"buyItems",kinds:0,buyId:this.buyId,buyCount:this.buyCount},s=JSON.stringify(i);GameSocket().Send(s),this.OnHide()},Setup:function(e){this.seedName.string=e.name,this.time.string=e.time.amount/60+"小时",this.output.string=e.output+"个",this.price.string=e.fruit.price+"金币",this.gains.string=e.output*e.fruit.price,this.getExp.string=e.sowExp+e.harvestExp+e.clearExp,this.buyId=e.id,this.buyPrice=e.buy,this.buyCount=0;var t=window.GameData;t.GetLevel()<e.minLevel?(this.buyBtn.interactable=!1,this.limitLevel.node.active=!0,this.limitLevel.string="需求Lv."+e.minLevel+"(等级不足)"):(this.limitLevel.node.active=!1,this.buyBtn.interactable=!0),this.OnAdd(null)}}),cc._RFpop()},{}],canvas:[function(e,t,n){"use strict";cc._RFpush(t,"e8895VhD7hAh6SOISVoNqK9","canvas"),cc.Class({"extends":cc.Component,properties:{gameNotify:cc.Prefab},onLoad:function(){}}),cc._RFpop()},{}],clearDisaster:[function(e,t,n){"use strict";cc._RFpush(t,"a7ba5iZgTVCs65ppDPuBXvh","clearDisaster");var i=e("msgHandler"),s={};s.interest="clearDisasterSuccess",s.Process=function(e){GameEvent().SendEvent("ClearDisasterSuccess"),1===e.disasterType?GameNotify().AddText("除虫成功!"):2===e.disasterType?GameNotify().AddText("浇水成功!"):3===e.disasterType&&GameNotify().AddText("营养添加成功!")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],detail:[function(e,t,n){"use strict";cc._RFpush(t,"0b4fcmzcGxLiKOLDwR+Zvy2","detail"),cc.Class({"extends":cc.Component,properties:{scrollView:cc.ScrollView,closeBtn:cc.Button,log1Prefab:cc.Prefab,log2Prefab:cc.Prefab,log3Prefab:cc.Prefab},onLoad:function(){this.closeBtn.node.on("click",this.OnClose,this),GameEvent().OnEvent("UpdateLogs",this.ReLoad,this)},OnClose:function(){this.OnHide()},OnShow:function(){this.node.active=!0,this.RequstLogs(),this.ReLoad()},OnHide:function(){this.node.active=!1},RequstLogs:function(){var e={type:"getLogs"},t=JSON.stringify(e);GameSocket().Send(t)},ReLoad:function(){var e=window.GameData,t=e.logs,n=this.scrollView.content;n.removeAllChildren();for(var i,s=0;s<t.length;++s)i=this.InitLogPerfab(t[s]),i&&n.addChild(i);this.scrollView.scrollToTop(.1)},InitLogPerfab:function(e){var t,n=null,i=null,s=JSON.parse(e.data),o=new Date,a=new Date(e.time),c="";if(o.getFullYear()===a.getFullYear()&&o.getMonth()===a.getMonth()&&(o.getDate()===a.getDate()?c="今天":o.getDate()-1===a.getDate()&&(c="昨天")),0===c.length&&(c+=a.getMonth()<9?"0"+(a.getMonth()+1):a.getMonth()+1,c+=o.getDate()<10?"0"+(a.getDate()+1):a.getDate()),1===e.type){var r=Table.GetEntry("plant",s[2]);s[4]===-1?(n=cc.instantiate(this.log1Prefab),i=n.getComponent(cc.RichText),t=i.string,t=t.replace(/name/,s[1]),t=t.replace(/fruitName/,r.fruit.name),t=t.replace(/number/,s[3])):(n=cc.instantiate(this.log2Prefab),t=n.getComponent(cc.RichText).string,t=t.replace(/name/,s[1]),t=t.replace(/fruitName/,r.fruit.name),t=t.replace(/number1/,s[3]),t=t.replace(/number1/,s[4]))}else 2===e.type&&(n=cc.instantiate(this.log3Prefab),i=n.getComponent(cc.RichText),t=i.string,t=t.replace(/name/,s[1]),1===e.subType?t=t.replace(/disasterName/,"虫灾"):2===e.subType?t=t.replace(/disasterName/,"旱灾"):3===e.subType&&(t=t.replace(/disasterName/,"营养流失")),t=t.replace(/exp/,s[2]));return t=t.replace(/time/,c),i&&(i.string=t),n}}),cc._RFpop()},{}],duihuan:[function(e,t,n){"use strict";cc._RFpush(t,"1d27dYq6JxBM6T6fiQdrByj","duihuan"),cc.Class({"extends":cc.Component,properties:{shangpinItem:cc.Prefab,shangpinScroll:cc.ScrollView,shangpinImg:cc.Sprite,shangpinNameLab:cc.Label,conditionLab:cc.Label,shangpinNumLab:cc.Label,shangpinSubBtn:cc.Button,shangpinAddBtn:cc.Button,duihuanBtn:cc.Button},onLoad:function(){}}),cc._RFpop()},{}],error:[function(e,t,n){"use strict";cc._RFpush(t,"e3e63hfLZdPjZl6YD4R3NNl","error");var i=e("msgHandler"),s={};s.interest="error",s.Process=function(e){GameLog(e);var t=Table.GetEntry("error",e.id);t&&(GameLog(t.description),GameNotify().AddText(t.description,ErrorNotifyColor))},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],friendHandler:[function(e,t,n){"use strict";cc._RFpush(t,"e1968tX8cNPGK0xKOkWCgEw","friendHandler");var i=e("msgHandler"),s={};s.interest="addFriendSuccess",s.Process=function(e){GameNotify().AddText("添加好友成功!")},i.Add(s);var o={};o.interest="removeFriendSuccess",o.Process=function(e){GameNotify().AddText("删除好友成功!")},i.Add(o),cc._RFpop()},{msgHandler:"msgHandler"}],friendsList:[function(e,t,n){"use strict";cc._RFpush(t,"cd235UIPCVNzJPpfOP1Jw+z","friendsList");var i=e("msgHandler"),s={};s.interest="friendsList",s.Process=function(e){var t=window.GameData;t.friendsList=e.list.slice(),GameEvent().SendEvent("UpdateFriendsList")},i.Add(s);var o={};o.interest="friendsListSuccess",o.Process=function(e){var t=window.GameData;t.friendsList=e.list.slice(),GameEvent().SendEvent("UpdateFriendsList")},i.Add(o),cc._RFpop()},{msgHandler:"msgHandler"}],gameData:[function(e,t,n){"use strict";cc._RFpush(t,"b1eb7lYRI5DV5yopcwfGiwY","gameData"),function(){var e={userId:-1,userName:"",money:0,experience:0,vip:0,lands:[],"package":[],neighbourList:[],friendsList:[],visitUser:{},logs:[]};e.GetUserId=function(){return this.userId},e.GetUserName=function(){return this.userName},e.GetMoney=function(){return this.money},e.GetLevel=function(){var e=1;return this.experience>0&&(e+=Math.floor(this.experience/200)),e},e.GetLevelByExp=function(e){var t=1;return e>0&&(t+=Math.floor(e/200)),t},e.GetLevelExp=function(){return this.experience%200},e.GetLevelExpByExp=function(e){return e%200},e.GetLevelExpMax=function(){return 200},"undefined"!=typeof t&&(t.exports=e),"undefined"!=typeof window&&(window.GameData=e)}(),cc._RFpop()},{}],gameEvent:[function(e,t,n){"use strict";cc._RFpush(t,"863b78ivfJOp5nxyBAag2+G","gameEvent");var i=cc.Class({"extends":cc.Component,statics:{inst:null},onLoad:function(){i.inst=this},OnEvent:function(e,t,n){this.node.on(e,t,n)},OffEvent:function(e,t,n){this.node.off(e,t,n)},SendEvent:function(e,t){this.node.emit(e,t)}});cc._RFpop()},{}],gameLayer:[function(e,t,n){"use strict";function i(e,t,n,i,s){var o=0,a=[0,0,0];if(t<e)return a;for(var c=Math.floor((t-e)/C),r=0;r<3;++r)if(o+=n[r],o>c){if("undefined"!=typeof s&&s){var d=Math.floor((s-t)/C);if(o-c>d)a[r]=Math.floor(d/b*i);else for(a[r]=Math.floor((o-c)/b*i),d-=o-c;++r<3;){if(!(d>n[r])){a[r]=Math.floor(d/b*i);break}a[r]=Math.floor(n[r]/b*i),d-=n[r]}break}a[r]=Math.floor((o-c)/b*i),o=0,c=0}return a}function s(e,t,n,s,o,a,c){var r=Math.floor((t-n)/C),d=r,l=[0,0,0];"undefined"!=typeof s&&s&&(l=i(n,s,o,a,c));for(var u=0;u<3;++u){if(o[u]+l[u]>e[u]+d)return[!1,u,o[u]+l[u]-e[u]-d];d=e[u]+d-(o[u]+l[u])}return[!0]}function o(e,t,n){var i=0,s="undefined"!=typeof e.clearDisasterTime?e.clearDisasterTime:(new Date).getTime();if("undefined"!=typeof e.disasterTime&&s>e.disasterTime&&(1===e.disasterType||3===e.disasterType)){var o=s-e.disasterTime,a=Math.floor(o/C/b);i=a*t.effect1,i=Math.min(i,t.maxEffect1),i=Math.floor(n.output*i)}return i}cc._RFpush(t,"0c2e7ISWOdImp7YKyyaFh8m","gameLayer");var a=1,c=2,r=3,d=4,l=5,u=6,h=7,p=8,f=9,m=10,g=0,v=1,y=2,C=6e4,b=60;cc.Class({"extends":cc.Component,properties:{landsPrefab:cc.Prefab,opertorBtnPrefab:cc.Prefab,cangKuSpr:cc.Sprite,refreshSecond:{"default":30,type:cc.Float}},onLoad:function(){this.scrollView=this.node.getComponent("cc.ScrollView"),this.content=this.scrollView.content,this.lands=this.content.getChildByName("lands"),this.touchNode=this.content.getChildByName("touchNode"),this.scrollView.horizontal=!1,this.scrollView.vertical=!1,this.ReLoadFunc=null,this.OperatorFunc=null,this.OnClearDisasterFunc=null,GameEvent().OnEvent("LoginSuccess",this.OnLoginSuccess,this),GameEvent().OnEvent("NeedCancelSelectLand",this.OnCancelSelectLand,this),GameEvent().OnEvent("EnterHome",this.OnEnterHome,this),GameEvent().OnEvent("VisitHome",this.OnVisitHome,this)},OnEnterHome:function(){GameEvent().OnEvent("UpdateBaseData",this.WarpReloadData,this),GameEvent().OnEvent("UpdateLands",this.WarpReloadData,this),GameEvent().OnEvent("UserSowSeeds",this.OnUserSowSeed,this),GameEvent().OnEvent("UserManure",this.OnUserManure,this),this.ReLoadFunc=this.ReLoadData,this.OperatorFunc=this.OperatorSelfLands,this.OnClearDisasterFunc=this.OnClearDisaster,this.cangKuSpr.node.targetOff(this),this.cangKuSpr.node.on(cc.Node.EventType.TOUCH_END,function(e){GameEvent().SendEvent("OpenWarehouse")}.bind(this),this),this.OnCancelSelectLand()},OnVisitHome:function(){GameEvent().OffEvent("UpdateBaseData",this.WarpReloadData,this),GameEvent().OffEvent("UpdateLands",this.WarpReloadData,this),GameEvent().OffEvent("UserSowSeeds",this.OnUserSowSeed,this),GameEvent().OffEvent("UserManure",this.OnUserManure,this),GameEvent().OnEvent("VisitUserLands",this.WarpReloadData,this),this.ReLoadFunc=this.VisitReLoadData,this.OperatorFunc=this.OperatorVisiUserLands,this.OnClearDisasterFunc=this.OnClearVisitUserDisaster,this.cangKuSpr.node.targetOff(this),this.cangKuSpr.node.on(cc.Node.EventType.TOUCH_END,function(){},this),this.OnCancelSelectLand()},start:function(){for(var e,t=0;t<4;++t)for(var n=0;n<3;++n){var i=window.GridToCoord(n,t);e=cc.instantiate(this.landsPrefab),e.x=i.x,e.y=i.y,e.getChildByName("tips").active=!1,this.lands.addChild(e)}},OnCancelSelectLand:function(){"undefined"!=typeof this.lastHightLight&&(this.HightLightLandsPrefab(this.lastHightLight,this.selectLandIndex,!1),this.lastHightLight=void 0,this.selectLandIndex=-1)},OnLoginSuccess:function(){this.scrollView.horizontal=!0,this.scrollView.vertical=!0,this.selectLandIndex=-1,this.ReLoadData(),this.touchNode.on(cc.Node.EventType.TOUCH_END,function(e){var t=this.lands.convertToNodeSpaceAR(e.getLocation()),n=window.CoordToGrid(t.x,t.y);if(n.x>=0&&n.x<3&&n.y>=0&&n.y<4){var i=n.x+3*n.y;if(i<12){var s=this.lands.children,o=s[i];"undefined"!=typeof this.lastHightLight&&this.HightLightLandsPrefab(this.lastHightLight,i,!1);var a=AudioMng();a&&a.playButton(),this.HightLightLandsPrefab(o,i,!0),this.lastHightLight=o,this.selectLandIndex=i}}else this.OnCancelSelectLand()}.bind(this))},WarpReloadData:function(){this.ReLoadFunc&&this.ReLoadFunc()},ReLoadData:function(){for(var e=window.GameData,t=e.lands,n=this.lands.children,i=0;i<n.length;++i)this.InitLandsPrefab(n[i],t[i],t.length===i)},VisitReLoadData:function(){var e=window.GameData,t=e.visitUser.lands;null===t&&(t=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0]);for(var n=this.lands.children,i=0;i<n.length;++i)this.InitLandsPrefab(n[i],t[i],t.length===i)},InitLandsPrefab:function(e,t,n){if("undefined"==typeof t)e.getChildByName("lands2").active=!0,e.getChildByName("lands1").active=!1,e.getChildByName("plant").active=!1,e.getChildByName("disaster").active=!1,e.getChildByName("time").active=!1;else if(e.getChildByName("lands2").active=!1,e.getChildByName("lands1").active=!0,e.getChildByName("disaster").active=!1,e.getChildByName("time").active=!1,0===t.state)e.getChildByName("plant").active=!1;else if(1===t.state){e.getChildByName("plant").active=!0;var i=Table.GetEntry("plant",t.seedId);if(i){var a=Table.GetEntry("disaster",i.disasterId);if(null===a)return;var c=e.getChildByName("time");c.active=!0;var r=c.getComponent(cc.Label);if("undefined"!=typeof t.disasterTime&&"undefined"==typeof t.clearDisasterTime){e.getChildByName("disaster").active=!0;var d=e.getChildByName("disaster").getComponent(cc.Sprite),l="disaster"+t.disasterType;cc.loader.loadRes(l,cc.SpriteFrame,function(e,t){d.spriteFrame=t})}var u="undefined"!=typeof t.disasterTime&&2===t.disasterType||3===t.disasterType?t.disasterTime:null,h="undefined"==typeof t.reduceTime?[0,0,0]:t.reduceTime,p=(new Date).getTime(),f=s(h,p,t.sowTime,u,i.time.part,a.effect2,t.clearDisasterTime),m=e.getChildByName("plant").getComponent(cc.Sprite),g="plant/"+i.time.images[0];if(f[0]){var v=o(t,a,i),y="undefined"==typeof t.stealCount?i.output:i.output-t.stealCount;r.string="植物已经成熟\n("+(y-v)+"/"+i.output+")",g="plant/"+i.time.images[2]}else{var C,O=f[1],L=f[2];0===O?(C="发芽",g="plant/"+i.time.images[0]):1==O?(C="开花",g="plant/"+i.time.images[1]):(C="结果",g="plant/"+i.time.images[1]);var S=Math.floor(L/b);r.string="剩余"+(S>0?S+"小时":"")+Math.floor(L%b)+"分钟"+C}cc.loader.loadRes(g,cc.SpriteFrame,function(e,t){m.spriteFrame=t})}}else if(2===t.state){var c=e.getChildByName("time");c.active=!0;var r=c.getComponent(cc.Label);r.string="果实已收割",e.getChildByName("plant").active=!0;var i=Table.GetEntry("plant",t.seedId),m=e.getChildByName("plant").getComponent(cc.Sprite),g="plant/"+i.time.images[3];cc.loader.loadRes(g,cc.SpriteFrame,function(e,t){m.spriteFrame=t})}e.getChildByName("openLands").active=n},HightLightLandsPrefab:function(e,t,n){var i,s;n?(i=e.getChildByName("lands1"),i.active&&(i.getComponent("cc.Sprite").dstBlendFactor=cc.BlendFunc.BlendFactor.ONE),s=e.getChildByName("lands2"),s.active&&(s.getComponent("cc.Sprite").dstBlendFactor=cc.BlendFunc.BlendFactor.ONE),this.WrapOperatorLands(e,t)):(i=e.getChildByName("lands1"),i.active&&(i.getComponent("cc.Sprite").dstBlendFactor=cc.BlendFunc.BlendFactor.ONE_MINUS_SRC_ALPHA),s=e.getChildByName("lands2"),s.active&&(s.getComponent("cc.Sprite").dstBlendFactor=cc.BlendFunc.BlendFactor.ONE_MINUS_SRC_ALPHA),this.CancelOperatorLands(e))},WrapOperatorLands:function(e,t){this.OperatorFunc&&this.OperatorFunc(e,t)},OperatorSelfLands:function(e,t){var n=window.GameData,i=n.lands;if(i.length>t){var o=i[t],f=e.getChildByName("operator");f.active=!0;var C;if(o.state===g){C=this.CreateOpertorButton(a),f.addChild(C);var b=Table.GetEntry("landsLevel",o.level+1);b&&b.minLevel<=n.GetLevel()&&b.landsNumber<=i.length&&(C=this.CreateOpertorButton(m),f.addChild(C))}else if(o.state===v){C=this.CreateOpertorButton(c),f.addChild(C);var O=Table.GetEntry("plant",o.seedId);if(O){var L=Table.GetEntry("disaster",O.disasterId);if(null===L)return;"undefined"!=typeof o.disasterType&&"undefined"==typeof o.clearDisasterTime&&(1===o.disasterType?(C=this.CreateOpertorButton(p),f.addChild(C)):2===o.disasterType?(C=this.CreateOpertorButton(u),f.addChild(C)):3===o.disasterType&&(C=this.CreateOpertorButton(h),f.addChild(C)));var S="undefined"!=typeof o.disasterTime&&2===o.disasterType||3===o.disasterType?o.disasterTime:null,B="undefined"==typeof o.reduceTime?[0,0,0]:o.reduceTime,E=(new Date).getTime(),P=s(B,E,o.sowTime,S,O.time.part,L.effect2,o.clearDisasterTime);P[0]?"undefined"!=typeof o.disasterType&&"undefined"==typeof o.clearDisasterTime||(C=this.CreateOpertorButton(l),f.addChild(C)):(C=this.CreateOpertorButton(d),f.addChild(C))}C=this.CreateOpertorButton(r),f.addChild(C)}else o.state===y&&(C=this.CreateOpertorButton(r),f.addChild(C))}else if(n.lands.length===t){var G={type:"unlockLands",landIndex:t},N=JSON.stringify(G);GameSocket().Send(N)}},OperatorVisiUserLands:function(e,t){var n=window.GameData,i=n.visitUser.lands;if("undefined"!=typeof i&&null!==i&&i.length>t){var o=i[t],a=e.getChildByName("operator");a.active=!0;var r;if(o.state===g);else if(o.state===v){r=this.CreateOpertorButton(c),a.addChild(r);var d=Table.GetEntry("plant",o.seedId);if(d){var l=Table.GetEntry("disaster",d.disasterId);if(null===l)return;"undefined"!=typeof o.disasterType&&"undefined"==typeof o.clearDisasterTime&&(1===o.disasterType?(r=this.CreateOpertorButton(p),a.addChild(r)):2===o.disasterType?(r=this.CreateOpertorButton(u),a.addChild(r)):3===o.disasterType&&(r=this.CreateOpertorButton(h),a.addChild(r)));var m="undefined"!=typeof o.disasterTime&&2===o.disasterType||3===o.disasterType?o.disasterTime:null,y="undefined"==typeof o.reduceTime?[0,0,0]:o.reduceTime,C=(new Date).getTime(),b=s(y,C,o.sowTime,m,d.time.part,l.effect2,o.clearDisasterTime);b[0]&&(r=this.CreateOpertorButton(f),a.addChild(r))}}}},CancelOperatorLands:function(e){var t=e.getChildByName("operator");t.removeAllChildren(),t.active=!1},CreateOpertorButton:function(e){var t,n=function(e,t){var n=e.getComponent("cc.Button");cc.loader.loadRes(t,cc.SpriteFrame,function(e,t){this.normalSprite=t,this.pressedSprite=t,this.hoverSprite=t,this.disabledSprite=t}.bind(n))},i=null;return e===a?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="播种",i.on("click",function(e){GameEvent().SendEvent("OpenPackage","sow")})):e===c?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="详细信息",i.on("click",function(e){})):e===r?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),i.on("click",function(e){this.OnUserRemovePlant()}.bind(this)),t.active=!1,n(i,"operate/chandi")):e===d?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="施肥",i.on("click",function(e){GameEvent().SendEvent("OpenPackage","manure")}),t.active=!1,n(i,"operate/shifei")):e===l?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="收割果实",i.on("click",function(e){this.OnUserHarvest()}.bind(this)),t.active=!1,n(i,"operate/quanShou")):e===u?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="浇水",i.on("click",function(e){this.OnWrapClearDisaster()}.bind(this)),t.active=!1,n(i,"operate/jiaoshui")):e===h?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="补充营养",i.on("click",function(e){this.OnWrapClearDisaster()}.bind(this))):e===p?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="除虫",i.on("click",function(e){this.OnWrapClearDisaster()}.bind(this)),t.active=!1,n(i,"operate/chuchong")):e===f?(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="偷盗",i.on("click",function(e){this.OnUserVisitSteal()}.bind(this))):e===m&&(i=cc.instantiate(this.opertorBtnPrefab),t=i.getComponent("cc.Button").node.getChildByName("Label"),t.getComponent("cc.Label").string="升级",i.on("click",function(e){this.OnLandsUpgread()}.bind(this))),i},OnUserSowSeed:function(e){var t=e.detail;if(this.selectLandIndex>=0){this.CancelOperatorLands(this.lastHightLight);var n=this.selectLandIndex,i={type:"sowSeeds",seedId:t,landIndex:n},s=JSON.stringify(i);GameSocket().Send(s)}},OnUserManure:function(e){var t=e.detail;if(this.selectLandIndex>=0){this.CancelOperatorLands(this.lastHightLight);var n=this.selectLandIndex,i={type:"manure",propertyId:t,landIndex:n},s=JSON.stringify(i);GameSocket().Send(s)}},OnUserRemovePlant:function(e){if(this.selectLandIndex>=0){this.CancelOperatorLands(this.lastHightLight);var t=this.selectLandIndex,n={type:"removePlant",landIndex:t},i=JSON.stringify(n);GameSocket().Send(i)}},OnUserHarvest:function(e){if(this.selectLandIndex>=0){this.CancelOperatorLands(this.lastHightLight);var t=this.selectLandIndex,n={type:"harvest",landIndex:t},i=JSON.stringify(n);GameSocket().Send(i)}},OnUserVisitSteal:function(e){if(this.selectLandIndex>=0){this.CancelOperatorLands(this.lastHightLight);var t=this.selectLandIndex,n=window.GameData,i=n.visitUser.userid,s={type:"visitSteal",visitUserId:i,landIndex:t},o=JSON.stringify(s);GameSocket().Send(o)}},OnWrapClearDisaster:function(e){this.OnClearDisasterFunc&&this.OnClearDisasterFunc(e)},OnClearDisaster:function(e){if(this.selectLandIndex>=0){this.CancelOperatorLands(this.lastHightLight);var t=this.selectLandIndex,n={type:"clearDisaster",landIndex:t},i=JSON.stringify(n);GameSocket().Send(i)}},OnClearVisitUserDisaster:function(e){if(this.selectLandIndex>=0){this.CancelOperatorLands(this.lastHightLight);var t=this.selectLandIndex,n=window.GameData,i=n.visitUser.userid,s={type:"visitClearDisaster",visitUserId:i,landIndex:t},o=JSON.stringify(s);GameSocket().Send(o)}},OnLandsUpgread:function(e){if(this.selectLandIndex>=0){this.CancelOperatorLands(this.lastHightLight);var t=this.selectLandIndex,n={type:"upgradeLands",landIndex:t},i=JSON.stringify(n);GameSocket().Send(i)}},update:function(e){"undefined"==typeof this.interval&&(this.interval=0),this.interval+=e;var t=this.refreshSecond/60;this.interval>t&&(this.ReLoadFunc&&this.ReLoadFunc(),this.interval-=t)}}),cc._RFpop()},{}],getLogs:[function(e,t,n){"use strict";cc._RFpush(t,"9f16fhfDRVO/5jhAu5TSSaM","getLogs");var i=e("msgHandler"),s={};s.interest="getLogsSuccess",s.Process=function(e){var t=window.GameData;t.logs=e.logs.slice(),GameEvent().SendEvent("UpdateLogs")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],goBack:[function(e,t,n){"use strict";cc._RFpush(t,"fcc0bo3P7ZASLOdUssCc8Qe","goBack"),cc.Class({"extends":cc.Component,properties:{goBackBtn:cc.Button},onLoad:function(){this.goBackBtn.node.on("click",this.OnGoBack,this)},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1},OnGoBack:function(){GameEvent().SendEvent("EnterHome"),GameEvent().SendEvent("UpdateLands"),GameEvent().SendEvent("UpdateUserInfo")}}),cc._RFpop()},{}],harvestLands:[function(e,t,n){"use strict";cc._RFpush(t,"4e41d4UI4ZAjJBpR13emG8I","harvestLands");var i=e("msgHandler"),s={};s.interest="harvestSuccess",s.Process=function(e){GameNotify().AddText("收割成功!")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],hecheng:[function(e,t,n){"use strict";cc._RFpush(t,"f05cdaEuUNHoKiUiVQR1TKt","hecheng"),cc.Class({"extends":cc.Component,properties:{propItem:cc.Prefab,cailiaoItem:cc.Prefab,propItemScroll:cc.ScrollView,duihuanBtn:cc.Button,propNameLab:cc.Label,propImag:cc.Sprite,buzutishiLab:cc.Label,hechengGoldLab:cc.Label,cailiaoScroll:cc.ScrollView,hechengBtn:cc.Button},onLoad:function(){}}),cc._RFpop()},{}],info:[function(e,t,n){"use strict";cc._RFpush(t,"500c7bFHShCj5AZu+ZpNbsG","info"),cc.Class({"extends":cc.Component,properties:{roleName:cc.Label,level:cc.Label,money:cc.Label,expProgress:cc.ProgressBar,bgSprite:cc.Sprite},onLoad:function(){GameEvent().OnEvent("EnterHome",this.OnEnterHome,this),GameEvent().OnEvent("VisitHome",this.OnVisitHome,this)},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1},OnClickBg:function(){GameEvent().SendEvent("OpenDetail")},OnEnterHome:function(){GameEvent().OnEvent("UpdateBaseData",this.ReLoadData,this),GameEvent().OnEvent("UpdateUserInfo",this.ReLoadData,this),GameEvent().OffEvent("UpdateVisitInfo",this.VisitReLoadData,this),this.bgSprite.node.on(cc.Node.EventType.TOUCH_END,this.OnClickBg,this)},OnVisitHome:function(){GameEvent().OffEvent("UpdateBaseData",this.ReLoadData,this),GameEvent().OffEvent("UpdateUserInfo",this.ReLoadData,this),GameEvent().OnEvent("UpdateVisitInfo",this.VisitReLoadData,this),this.bgSprite.node.off(cc.Node.EventType.TOUCH_END,this.OnClickBg,this)},ReLoadData:function(){var e=window.GameData;this.roleName.string=e.GetUserName()+"的家园",this.money.string=e.GetMoney(),this.level.string="Lv."+e.GetLevel(),this.expProgress.progress=e.GetLevelExp()/e.GetLevelExpMax();var t=this.expProgress.node.getChildByName("value").getComponent("cc.Label");t.string=e.GetLevelExp()+"/"+e.GetLevelExpMax()},VisitReLoadData:function(e){var t=e.detail,n=window.GameData;this.roleName.string=t.username+"的家园",this.money.string=t.money,this.level.string="Lv."+n.GetLevelByExp(t.experience),this.expProgress.progress=n.GetLevelExpByExp(t.experience)/n.GetLevelExpMax();var i=this.expProgress.node.getChildByName("value").getComponent("cc.Label");i.string=n.GetLevelExpByExp(t.experience)+"/"+n.GetLevelExpMax()}}),cc._RFpop()},{}],loginHandler:[function(e,t,n){"use strict";cc._RFpush(t,"dc886cpH0JA95NAuisHz8Rb","loginHandler");var i=e("msgHandler"),s={};s.interest="loginSuccess",s.Process=function(e){GameEvent().SendEvent("LoginSuccess")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],login:[function(e,t,n){"use strict";cc._RFpush(t,"69ac94zGKRA/rekHALWuDIK","login"),cc.Class({"extends":cc.Component,properties:{loginBtn:cc.Button,registerBtn:cc.Button,inputAccount:cc.EditBox,inputPassword:cc.EditBox},onLoad:function(){this.loginBtn.node.on("click",this.OnLogin,this),this.registerBtn.node.on("click",this.OnRegister,this)},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1},OnLogin:function(e){if(0===this.inputAccount.string.length)return void GameNotify().AddText("请输入账号");if(0===this.inputPassword.string.length)return void GameNotify().AddText("请输入密码 ");var t={type:"login",account:this.GetAccount(),password:this.GetPassword()},n=JSON.stringify(t);GameSocket().Send(n)},OnRegister:function(e){GameEvent().SendEvent("GoRegister")},GetAccount:function(){return this.inputAccount.string},GetPassword:function(){return this.inputPassword.string}}),cc._RFpop()},{}],main:[function(e,t,n){"use strict";cc._RFpush(t,"f6babQhRldN7qU5r2qiWXpj","main"),cc.Class({"extends":cc.Component,properties:{infoPnl:cc.Node,toolbarPnl:cc.Node,loginPnl:cc.Node,registerPnl:cc.Node,shopPnl:cc.Node,packagePnl:cc.Node,buySeedPnl:cc.Node,buyPropPnl:cc.Node,sellFruitPnl:cc.Node,warehousePnl:cc.Node,socialPnl:cc.Node,visitPnl:cc.Node,goBackPnl:cc.Node,detailPnl:cc.Node},onLoad:function(){this.HideAllPnl(),GameLog("main onLoad");window.AudioMng()},start:function(){GameSocket().Connect(window.GameHost,window.GameProt),GameEvent().OnEvent("connectedServer",this.OnConectServe,this),GameEvent().OnEvent("GoRegister",this.OnGoRegister,this),GameEvent().OnEvent("LoginSuccess",this.OnLoginSuccess,this),GameEvent().OnEvent("CancelRegister",this.OnCancelRegister,this),GameEvent().OnEvent("RegisterSuccess",this.OnRegisterSuccess,this),GameEvent().OnEvent("BuyItemsSuccess",this.OnBuyItemsSuccess,this),GameEvent().OnEvent("OpenShop",this.OnOpenShop,this),GameEvent().OnEvent("OpenPackage",this.OnOpenPackage,this),GameEvent().OnEvent("OpenBuySeed",this.OnOpenBuySeed,this),GameEvent().OnEvent("OpenBuyProperty",this.OnOpenBuyProperty,this),GameEvent().OnEvent("OpenWarehouse",this.OnOpenWarehouse,this),GameEvent().OnEvent("OpenSellFruit",this.OnOpenSellFruit,this),GameEvent().OnEvent("OpenDetail",this.OnOpenDetail,this),GameEvent().OnEvent("EnterHome",this.OnEnterHome,this),GameEvent().OnEvent("VisitHome",this.OnVisitHome,this)},OnEnterHome:function(){this.visitPnl.getComponent("visit").OnHide(),this.goBackPnl.getComponent("goBack").OnHide(),this.toolbarPnl.getComponent("toolbar").OnShow()},OnVisitHome:function(){this.visitPnl.getComponent("visit").OnShow(),this.goBackPnl.getComponent("goBack").OnShow(),this.toolbarPnl.getComponent("toolbar").OnHide()},HideAllPnl:function(){this.infoPnl.getComponent("info").OnHide(),this.toolbarPnl.getComponent("toolbar").OnHide(),this.loginPnl.getComponent("login").OnHide(),this.registerPnl.getComponent("register").OnHide(),this.shopPnl.getComponent("shop").OnHide(),this.packagePnl.getComponent("package").OnHide(),this.buySeedPnl.getComponent("buySeed").OnHide(),this.buyPropPnl.getComponent("buyProperty").OnHide(),this.sellFruitPnl.getComponent("sellFruit").OnHide,this.warehousePnl.getComponent("warehouse").OnHide()},OnConectServe:function(e){GameLog("OnConectServe"),this.loginPnl.getComponent("login").OnShow();
},OnGoRegister:function(e){this.loginPnl.getComponent("login").OnHide(),this.registerPnl.getComponent("register").OnShow()},OnLoginSuccess:function(e){GameLog("登录成功"),this.HideAllPnl(),this.infoPnl.getComponent("info").OnShow(),this.toolbarPnl.getComponent("toolbar").OnShow(),this.socialPnl.getComponent("social").OnShow(),GameEvent().SendEvent("EnterHome")},OnCancelRegister:function(e){this.loginPnl.getComponent("login").OnShow(),this.registerPnl.getComponent("register").OnHide()},OnRegisterSuccess:function(e){this.loginPnl.getComponent("login").OnShow(),this.registerPnl.getComponent("register").OnHide()},OnBuyItemsSuccess:function(e){this.buySeedPnl.getComponent("buySeed").OnHide(),this.buyPropPnl.getComponent("buyProperty").OnHide()},OnOpenShop:function(e){this.shopPnl.getComponent("shop").OnShow(),GameEvent().SendEvent("NeedCancelSelectLand")},OnOpenPackage:function(e){var t=this.packagePnl.getComponent("package");t.OnShow(),t.OpenWith(e.detail)},OnOpenBuySeed:function(e){var t=this.buySeedPnl.getComponent("buySeed");t.OnShow(),t.Setup(e.detail)},OnOpenBuyProperty:function(e){var t=this.buyPropPnl.getComponent("buyProperty");t.OnShow(),t.Setup(e.detail)},OnOpenWarehouse:function(e){var t=this.warehousePnl.getComponent("warehouse");t.OnShow(),GameEvent().SendEvent("NeedCancelSelectLand")},OnOpenSellFruit:function(e){var t=this.sellFruitPnl.getComponent("sellFruit");t.OnShow(),t.Setup(e.detail)},OnOpenDetail:function(e){var t=this.detailPnl.getComponent("detail");t.OnShow()}}),cc._RFpop()},{}],manureLands:[function(e,t,n){"use strict";cc._RFpush(t,"19dd9UWpJ1Il7IACP7pUdMq","manureLands");var i=e("msgHandler"),s={};s.interest="manureSuccess",s.Process=function(e){GameNotify().AddText("施肥成功!")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],maskLayer:[function(e,t,n){"use strict";cc._RFpush(t,"b1c74rq4bhEX4QlqH8KfxeH","maskLayer"),cc.Class({"extends":cc.Component,onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_END,function(e){})}}),cc._RFpop()},{}],msgHandler:[function(e,t,n){"use strict";cc._RFpush(t,"bf199399u1H4Z4f07UIDO9L","msgHandler"),function(){var e={};e.Add=function(e){"string"==typeof e.interest&&"function"==typeof e.Process?(this[e.interest]=e.Process,GameLog("Add handler :"+e.interest)):GameLog("error type of handler"+e)},e.Process=function(e){"string"==typeof e.type&&"function"==typeof this[e.type]?this[e.type](e):GameLog("invalid massage ->>"+e)},"undefined"!=typeof t&&(t.exports=e),"undefined"!=typeof window&&(window.MessageHandler=e)}(),cc._RFpop()},{}],neighbourList:[function(e,t,n){"use strict";cc._RFpush(t,"cf5e4dgpbZOS7sEK+/Nrr8r","neighbourList");var i=e("msgHandler"),s={};s.interest="neighbourList",s.Process=function(e){var t=window.GameData;t.neighbourList=e.list.slice(),GameEvent().SendEvent("UpdateNeighbourList")},i.Add(s);var o={};o.interest="neighbourListSuccess",o.Process=function(e){var t=window.GameData;t.neighbourList=e.list.slice(),GameEvent().SendEvent("UpdateNeighbourList")},i.Add(o),cc._RFpop()},{msgHandler:"msgHandler"}],notifyText:[function(e,t,n){"use strict";cc._RFpush(t,"6311aEnqulPi492lRJveIXd","notifyText");var i=cc.Class({"extends":cc.Component,properties:{textPrefab:cc.Prefab},statics:{inst:null},onLoad:function(){i.inst=this,this.entityPool=new cc.NodePool;for(var e=5,t=0;t<e;++t){var n=cc.instantiate(this.textPrefab);this.entityPool.put(n)}},AddText:function(e,t,n){var i=null;i=this.entityPool.size()>0?this.entityPool.get():cc.instantiate(this.textPrefab),i.parent=this.node,i.color=t?t:cc.Color.GREEN;var s=i.getComponent("cc.Label");s.string=e,s.fontSize=n?n:30;var o=cc.director.getWinSize(),a=cc.moveBy(2,cc.p(0,o.height/8*3)),c=cc.callFunc(this._RemoveText,this,i),r=cc.sequence(a,c);i.runAction(r)},_RemoveText:function(e){this.node.removeChild(e),this.entityPool.put(e)}});cc._RFpop()},{}],"package":[function(e,t,n){"use strict";cc._RFpush(t,"f19b3ye65tJmY2tT2nWSo9d","package");var i=0,s=1,o=2;cc.Class({"extends":cc.Component,properties:{seedPrefab:cc.Prefab,propertyPrefab:cc.Prefab,scrollView:cc.ScrollView,radioButton:{"default":[],type:cc.Toggle},_currentToggle:cc.Toggle,closeBtn:cc.Button},onLoad:function(){this.closeBtn.node.on("click",this.OnClose,this);for(var e=0;e<this.radioButton.length;++e)if(this.radioButton[e].isChecked){this._currentToggle=this.radioButton[e];break}GameEvent().OnEvent("UpdatePackage",this.Load,this)},OnShow:function(){this.node.active=!0,this.Load()},OnHide:function(){this.node.active=!1},Load:function(){if(this.node.active){var e=this.radioButton.indexOf(this._currentToggle);if(e>=0){var t=new Array(["plant",this.seedPrefab,this.InitSeedPrefab],["property",this.propertyPrefab,this.InitPropPrefab]),n=this.scrollView.content;if(n.removeAllChildren(),t.length>e){var i=window.GameData,s=i["package"];if("undefined"!=typeof s[e]){var o,a,c;for(var r in s[e])s[e][r]>0&&(o=parseInt(r),a=Table.GetEntry(t[e][0],o),c=cc.instantiate(t[e][1]),t[e][2].bind(this)(c,a,s[e][r]),n.addChild(c));this.scrollView.scrollToTop(.1)}}}}},OpenWith:function(e){"undefined"==typeof e?this.openReason=i:"sow"===e?(this.openReason=s,this.radioButton[0].check()):"manure"===e?(this.openReason=o,this.radioButton[1].check()):this.openReason=i},InitSeedPrefab:function(e,t,n){var i=e.getChildByName("name").getComponent("cc.Label");i.string=t.name;var s=e.getChildByName("level").getComponent("cc.Label");s.string=t.minLevel+"级";var o=e.getChildByName("count").getComponent("cc.Label");o.string="数量:"+n,e.config=t,e.on(cc.Node.EventType.TOUCH_END,function(e){this.OnSeedClick(e.target.config)}.bind(this))},InitPropPrefab:function(e,t,n){var i=e.getChildByName("name").getComponent("cc.Label");i.string=t.name;var s=e.getChildByName("count").getComponent("cc.Label");s.string="数量:"+n,e.config=t,e.on(cc.Node.EventType.TOUCH_END,function(e){this.OnPropertyClikc(e.target.config)}.bind(this))},radioButtonClicked:function(e){this._currentToggle!==e&&(this._currentToggle=e,this.Load())},OnSeedClick:function(e){this.openReason===s&&(this.OnHide(),GameEvent().SendEvent("UserSowSeeds",e.id))},OnPropertyClikc:function(e){this.openReason===o&&(this.OnHide(),GameEvent().SendEvent("UserManure",e.id))},OnClose:function(){this.OnHide()}}),cc._RFpop()},{}],petLayer:[function(e,t,n){"use strict";cc._RFpush(t,"c68f40tLqlPFbihPADRlB+R","petLayer"),cc.Class({"extends":cc.Component,properties:{petItemPrefab:cc.Prefab,petScorllView:cc.ScrollView,petNameLab:cc.Label,petImag:cc.Sprite,petInfo:cc.Label,xufeiBtn:cc.Button,tihuanBtn:cc.Button,buyBtn:cc.Button,closeBtn:cc.Button},onLoad:function(){}}),cc._RFpop()},{}],registerHander:[function(e,t,n){"use strict";cc._RFpush(t,"0d938HjkqRBhprE7RodwBx1","registerHander");var i=e("msgHandler"),s={};s.interest="registerSuccess",s.Process=function(e){GameEvent().SendEvent("RegisterSuccess")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],register:[function(e,t,n){"use strict";cc._RFpush(t,"83632q929pAyqfS/6vYW90v","register"),cc.Class({"extends":cc.Component,properties:{registerBtn:cc.Button,cancelBtn:cc.Button,inputAccount:cc.EditBox,inputPassword:cc.EditBox},onLoad:function(){this.registerBtn.node.on("click",this.OnRegister,this),this.cancelBtn.node.on("click",this.OnCancel,this)},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1},OnRegister:function(e){if(0===this.inputAccount.string.length)return void GameNotify().AddText("请输入账号");if(0===this.inputPassword.string.length)return void GameNotify().AddText("请输入密码 ");var t={type:"register",account:this.GetAccount(),password:this.GetPassword()},n=JSON.stringify(t);GameSocket().Send(n)},OnCancel:function(e){GameEvent().SendEvent("CancelRegister")},GetAccount:function(){return this.inputAccount.string},GetPassword:function(){return this.inputPassword.string}}),cc._RFpop()},{}],removePlant:[function(e,t,n){"use strict";cc._RFpush(t,"fac37jQz3lLp43mZnamrGPh","removePlant");var i=e("msgHandler"),s={};s.interest="removePlantSuccess",s.Process=function(e){GameLog(e),GameNotify().AddText("铲除成功")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],sellFruitHander:[function(e,t,n){"use strict";cc._RFpush(t,"e076d1POXxMkY6zps6Ur9SM","sellFruitHander");var i=e("msgHandler"),s={};s.interest="sellFruitSuccess",s.Process=function(e){GameNotify().AddText("出售成功!")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],sellFruit:[function(e,t,n){"use strict";cc._RFpush(t,"f9346Fbh+BE7qdeCF0ceJ55","sellFruit"),cc.Class({"extends":cc.Component,properties:{addBtn:cc.Button,subBtn:cc.Button,sellBtn:cc.Button,cancelBtn:cc.Button,sellNumber:cc.Label,fruitName:cc.Label,price:cc.Label,amount:cc.Label},onLoad:function(){this.addBtn.node.on("click",this.OnAdd,this),this.subBtn.node.on("click",this.OnSub,this),this.sellBtn.node.on("click",this.OnSell,this),this.cancelBtn.node.on("click",function(e){this.OnHide()}.bind(this))},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1},OnAdd:function(e){this.sellCount+=1,this.sellCount<=0&&(this.sellCount=1),this.sellCount>this.hasCount?(this.sellCount=this.hasCount,this.addBtn.interactable=!1):this.addBtn.interactable=!0,this.sellNumber.string=this.sellCount,this.amount.string=this.sellCount*this.sellPrice+"金币",this.sellCount>1&&(this.subBtn.interactable=!0)},OnSub:function(e){this.sellCount-=1,this.sellCount<=0&&(this.sellCount=1,this.subBtn.interactable=!1),this.sellNumber.string=this.sellCount,this.amount.string=this.sellCount*this.sellPrice+"金币",this.sellCount<this.hasCount&&(this.addBtn.interactable=!0)},OnSell:function(e){var t=window.GameData;if(t["package"][2][this.fruitId]<this.sellCount){var n=Table.GetEntry("error",17);return void(n&&GameNotify().AddText(n.description,window.ErrorNotifyColor))}var i={type:"sellFruit",fruitId:this.fruitId,count:this.sellCount},s=JSON.stringify(i);GameSocket().Send(s),this.OnHide()},Setup:function(e){this.fruitName.string=e.fruit.name,this.price.string=e.fruit.price+"金币",this.fruitId=e.id,this.sellPrice=e.fruit.price;var t=window.GameData;this.hasCount=0,"undefined"!=typeof t["package"][2][e.id]&&t["package"][2][e.id]>0&&(this.hasCount=t["package"][2][e.id]),this.sellCount=this.hasCount,this.OnAdd()}}),cc._RFpop()},{}],sell:[function(e,t,n){"use strict";cc._RFpush(t,"bc2b7s9RRJKkoJCsF5ZJcqy","sell"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){}}),cc._RFpop()},{}],shop:[function(e,t,n){"use strict";cc._RFpush(t,"1b823M9uh9CW7iwBEZYCSqk","shop"),cc.Class({"extends":cc.Component,properties:{shopSeedItemPrefab:cc.Prefab,shopPropItemPrefab:cc.Prefab,shopPetItemPrefab:cc.Prefab,scrollView:cc.ScrollView,radioButton:{"default":[],type:cc.Toggle},_currentToggle:cc.Toggle,closeBtn:cc.Button,itemImag:cc.Sprite,itemNameLab:cc.Label,itemInfoLab:cc.Label,itemNumLab:cc.Label,itemSubBtn:cc.Button,itemAddBtn:cc.Button,itemGoldLab:cc.Label,itemBuyBtn:cc.Button},onLoad:function(){this.closeBtn.node.on("click",this.OnClose,this);for(var e=0;e<this.radioButton.length;++e)if(this.radioButton[e].isChecked){this._currentToggle=this.radioButton[e];break}},OnShow:function(){this.node.active=!0,this.Load()},OnHide:function(){this.node.active=!1},Load:function(){var e=this.radioButton.indexOf(this._currentToggle);if(e>=0){var t=new Array(["plant",this.shopSeedItemPrefab,this.InitSeedPrefab],["property",this.shopPropItemPrefab,this.InitPropPrefab],["pet",this.shopPetItemPrefab,this.InitPetPrefab]),n=this.scrollView.content;if(n.removeAllChildren(),t.length>e){var i=Table.GetEntry("shop",e+1);if(i&&i.sell.length>0){for(var s,o,a,c=0;c<i.sell.length;++c)s=i.sell[c],o=Table.GetEntry(t[e][0],s),a=cc.instantiate(t[e][1]),t[e][2].bind(this)(a,o),n.addChild(a);this.scrollView.scrollToTop(.1)}}}},InitSeedPrefab:function(e,t){var n=e.getChildByName("name").getComponent("cc.Label");n.string=t.name;var i=e.getChildByName("level").getComponent("cc.Label");i.string=t.minLevel+"级";var s=e.getChildByName("money").getComponent("cc.Label");s.string=t.buy+"金币",e.config=t,e.on(cc.Node.EventType.TOUCH_END,function(e){this.OnOpenBuySeed(e.target.config)}.bind(this))},OnOpenBuySeed:function(e){GameEvent().SendEvent("OpenBuySeed",e)},InitPropPrefab:function(e,t){var n=e.getChildByName("icon").getComponent("cc.Sprite");cc.loader.loadRes(t.imagPath,cc.SpriteFrame,function(e,t){this.spriteFrame=t}.bind(n));var i=e.getChildByName("name").getComponent("cc.Label");i.string=t.name;var s=e.getChildByName("money").getComponent("cc.Label");s.string=t.buy+"金币",e.config=t,e.on(cc.Node.EventType.TOUCH_END,function(e){this.OnOpenBuyProp(e.target.config)},this)},OnOpenBuyProp:function(e){GameEvent().SendEvent("OpenBuyProperty",e)},InitPetPrefab:function(e,t){var n=e.getChildByName("icon").getComponent("cc.Sprite");cc.loader.loadRes(t.headImagPath,cc.SpriteFrame,function(e,t){this.spriteFrame=t}.bind(n));var i=e.getChildByName("name").getComponent("cc.Label");i.string=t.name,e.on(cc.Node.EventType.TOUCH_END,function(e){this.OnOpenBuyPet(e.target.config)},this)},OnOpenBuyPet:function(e){GameEvent().SendEvent("OpenBuyPet",e)},radioButtonClicked:function(e){this._currentToggle!==e&&(this._currentToggle=e,this.Load())},OnClose:function(){this.OnHide()}}),cc._RFpop()},{}],social:[function(e,t,n){"use strict";cc._RFpush(t,"cba04NXrWNLzoiXEbjNHFfP","social"),cc.Class({"extends":cc.Component,properties:{radioButton:{"default":[],type:cc.Toggle},flodButton:cc.Button,scrollView:cc.ScrollView,itemPrefab:cc.Prefab,_currentToggle:cc.Toggle,_flodState:cc.Integer},onLoad:function(){this._flodState=0,this.flodButton.node.on("click",this.OnFold,this),this.OnFold();for(var e=0;e<this.radioButton.length;++e)if(this.radioButton[e].isChecked){this._currentToggle=this.radioButton[e];break}GameEvent().OnEvent("UpdateNeighbourList",this.Reload,this),GameEvent().OnEvent("UpdateFriendsList",this.Reload,this)},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1},radioButtonClicked:function(e){this._currentToggle!==e&&(this._currentToggle=e,this.Reload())},OnFold:function(){var e;0===this._flodState?(e=this.node.getComponent(cc.Widget),e.right=-300,this._flodState=1,this.scrollView.scrollToTop(.1)):(e=this.node.getComponent(cc.Widget),e.right=4,this._flodState=0,this.scrollView.scrollToTop(.1))},Reload:function(){var e=this.radioButton.indexOf(this._currentToggle);if(e>=0){var t=this.scrollView.content;t.removeAllChildren();var n,i,s,o=window.GameData;if(0===e){var a=o.neighbourList;for(s=0;s<a.length;++s)n=cc.instantiate(this.itemPrefab),i=a[s],this.InitItemPrefab(n,i),t.addChild(n)}else if(1===e){var c=o.friendsList;for(s=0;s<c.length;++s)n=cc.instantiate(this.itemPrefab),i=c[s],this.InitItemPrefab(n,i),t.addChild(n)}}},InitItemPrefab:function(e,t){var n=e.getChildByName("name").getComponent("cc.Label");n.string=t.username;var i=e.getChildByName("level").getComponent("cc.Label");i.string="Lv."+GameData.GetLevelByExp(t.experience);var s=e.getChildByName("visit");s.userId=t.id,s.on("click",this.OnVisit,this)},OnVisit:function(e){var t=e.target.userId,n={type:"visitHome",userId:t},i=JSON.stringify(n);GameSocket().Send(i)}}),cc._RFpop()},{}],socket:[function(e,t,n){"use strict";cc._RFpush(t,"a6873XdOGBBNaNL7VhdxpQ+","socket");var i=cc.Class({"extends":cc.Component,statics:{inst:null},onLoad:function(){i.inst=this,this.connected=!1,this.webSocket=null},Connect:function(e,t,n){var i=this;if(!i.webSocket)try{var s=new WebSocket("ws://"+e+":"+t+"/"+("undefined"!=typeof n?n:""));s.onopen=function(e){i.connected=!0,i.webSocket=s,GameEvent().SendEvent("connectedServer")},s.onmessage=function(e){i.OnReceiveMessage(e)},s.onerror=function(e){GameLog("GameSocket error!!!!")},s.onclose=function(e){GameLog("GameSocket closed."),i.connected=!1,GameNotify().AddText("连接服务器失败!",new cc.Color(255,32,32))}}catch(o){GameLog(o)}},IsConnected:function(){return this.connected},OnReceiveMessage:function(e){var t=e.data;console.log("Receive data:"+t);try{var n=JSON.parse(t);MessageHandler.Process(n)}catch(e){GameLog(e)}},Send:function(e){this.connected&&this.webSocket.send(e)}});cc._RFpop()},{}],sowSeeds:[function(e,t,n){"use strict";cc._RFpush(t,"8436dsX3GdA27FeT0WUC4mm","sowSeeds");var i=e("msgHandler"),s={};s.interest="sowSeedsSuccess",s.Process=function(e){GameLog(e),GameNotify().AddText("播种成功")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],toolbar:[function(e,t,n){"use strict";cc._RFpush(t,"0a2c4MVMjNCg4dSQx6HQWwO","toolbar"),cc.Class({"extends":cc.Component,properties:{shopBtn:cc.Button,packageBtn:cc.Button},onLoad:function(){this.shopBtn.node.on("click",function(){GameEvent().SendEvent("OpenShop")}),this.packageBtn.node.on("click",function(){GameEvent().SendEvent("OpenPackage")})},OnShow:function(){this.node.active=!0},OnHide:function(){this.node.active=!1}}),cc._RFpop()},{}],unlockLands:[function(e,t,n){"use strict";cc._RFpush(t,"acc5fKIFnlG1a8JmLDtwrEO","unlockLands");var i=e("msgHandler"),s={};s.interest="unlockLandsSuccess",s.Process=function(e){GameLog(e),GameNotify().AddText("扩建土地成功")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],upgradeLands:[function(e,t,n){"use strict";cc._RFpush(t,"2983awHQPpL1a9J7rfXByIH","upgradeLands");var i=e("msgHandler"),s={};s.interest="upgradeLandsSuccess",s.Process=function(e){GameNotify().AddText("土地升级成功!")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],userBaseData:[function(e,t,n){"use strict";cc._RFpush(t,"aac4bOG2OBAEZ78IJJ4C9ry","userBaseData");var i=e("msgHandler"),s={};s.interest="userBaseData",s.Process=function(e){var t=window.GameData;t.userId=e.id,t.userName=e.username,t.money=e.money,t.experience=e.experience,t.vip=e.vip,t.lands=JSON.parse(e.lands),t["package"]=JSON.parse(e["package"]),GameEvent().SendEvent("UpdateBaseData")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],userDataSync:[function(e,t,n){"use strict";cc._RFpush(t,"37dc3E2WXtHFbxFN5E1HTL1","userDataSync");var i=e("msgHandler"),s={};s.interest="userDataSync",s.Process=function(e){var t=window.GameData,n=!1;"undefined"!=typeof e.money&&(t.money=e.money,n=!0),"undefined"!=typeof e.experience&&(t.experience=e.experience,n=!0),"undefined"!=typeof e.vip&&(t.vip=e.vip,n=!0),"undefined"!=typeof e.lands&&(t.lands=JSON.parse(e.lands),GameEvent().SendEvent("UpdateLands")),"undefined"!=typeof e["package"]&&(t["package"]=JSON.parse(e["package"]),GameEvent().SendEvent("UpdatePackage")),n&&GameEvent().SendEvent("UpdateUserInfo")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],visitClearDisaster:[function(e,t,n){"use strict";cc._RFpush(t,"3a92bxVC2BOf6CA9lMNUD+N","visitClearDisaster");var i=e("msgHandler"),s={};s.interest="visitClearDisasterSuccess",s.Process=function(e){var t=window.GameData,n=e.visitUserId,i=e.lands;1===e.disasterType?GameNotify().AddText("除虫成功!"):2===e.disasterType?GameNotify().AddText("浇水成功!"):3===e.disasterType&&GameNotify().AddText("营养添加成功!"),t.visitUser.userid===n&&(t.visitUser.lands=i.slice(),GameEvent().SendEvent("VisitUserLands"))},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],visitHome:[function(e,t,n){"use strict";cc._RFpush(t,"0772d7783hDhruxwTPM37Iz","visitHome");var i=e("msgHandler"),s={};s.interest="visitHomeSuccess",s.Process=function(e){var t=window.GameData,n=e;t.visitUser={userid:n.userid,username:n.username,money:n.money,experience:n.experience,vip:n.vip,lands:JSON.parse(n.lands)},GameEvent().SendEvent("VisitHome"),GameEvent().SendEvent("UpdateVisitInfo",t.visitUser),GameEvent().SendEvent("VisitUserLands")},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],visitSteal:[function(e,t,n){"use strict";cc._RFpush(t,"26b2f7dzYxAQZVXcUAMgKN9","visitSteal");var i=e("msgHandler"),s={};s.interest="visitStealSuccess",s.Process=function(e){var t=window.GameData,n=e.visitUserId,i=e.lands;GameNotify().AddText("偷取成功!"),t.visitUser.userid===n&&(t.visitUser.lands=i.slice(),GameEvent().SendEvent("VisitUserLands"))},i.Add(s),cc._RFpop()},{msgHandler:"msgHandler"}],visit:[function(e,t,n){"use strict";cc._RFpush(t,"30115E4E6RNaIQ31YoiZqUh","visit"),cc.Class({"extends":cc.Component,properties:{friendBtn:cc.Button,messageBtn:cc.Button,friendLabel:cc.Label},onLoad:function(){this.friendBtn.node.on("click",this.OnFriendClick,this),this.messageBtn.node.on("click",this.OnMessageClick,this),GameEvent().OnEvent("UpdateFriendsList",this.UpdateFriendLabel,this)},OnShow:function(){this.node.active=!0,this.UpdateFriendLabel()},OnHide:function(){this.node.active=!1},OnFriendClick:function(){var e,t,n=window.GameData,i=n.visitUser.userid;t=this.IsFriendOfVisit(),e=t===!1?{type:"addFriend",addUserId:i}:{type:"removeFriend",removeUserId:i};var s=JSON.stringify(e);GameSocket().Send(s)},OnMessageClick:function(){},IsFriendOfVisit:function(){for(var e=!1,t=window.GameData,n=t.visitUser.userid,i=t.friendsList,s=0;s<i.length;++s)if(i[s].id===n){e=!0;break}return e},UpdateFriendLabel:function(){var e=this.IsFriendOfVisit();e?this.friendLabel.string="解除\n好友":this.friendLabel.string="添加\n好友"}}),cc._RFpop()},{}],warehouse:[function(e,t,n){"use strict";cc._RFpush(t,"5f12bh6LmFEorn6viVVDOUf","warehouse"),cc.Class({"extends":cc.Component,properties:{fruitPrefab:cc.Prefab,scrollView:cc.ScrollView,closeBtn:cc.Button},onLoad:function(){this.closeBtn.node.on("click",this.OnClose,this),GameEvent().OnEvent("UpdatePackage",this.Load,this)},OnShow:function(){this.node.active=!0,this.Load()},OnHide:function(){this.node.active=!1},Load:function(){if(this.node.active){var e=this.scrollView.content;e.removeAllChildren();var t=window.GameData,n=t["package"],i=2;if("undefined"!=typeof n[i]){var s,o,a;for(var c in n[i])n[i][c]>0&&(s=parseInt(c),o=Table.GetEntry("plant",s),a=cc.instantiate(this.fruitPrefab),this.InitFruitPrefab(a,o,n[i][c]),e.addChild(a));this.scrollView.scrollToTop(.1)}}},InitFruitPrefab:function(e,t,n){var i=e.getChildByName("name").getComponent("cc.Label");i.string=t.fruit.name;var s=e.getChildByName("level").getComponent("cc.Label");s.string=t.minLevel+"级";var o=e.getChildByName("count").getComponent("cc.Label");o.string="数量:"+n,e.config=t,e.on(cc.Node.EventType.TOUCH_END,function(e){this.OnFruitClick(e.target.config)}.bind(this))},OnFruitClick:function(e){GameEvent().SendEvent("OpenSellFruit",e)},OnClose:function(){this.OnHide()}}),cc._RFpop()},{}]},{},["AudioMng","ButtonScaler","canvas","gameData","gameEvent","gameLayer","buyItemsHandler","clearDisaster","error","friendHandler","friendsList","getLogs","harvestLands","loginHandler","manureLands","neighbourList","registerHander","removePlant","sellFruitHander","sowSeeds","unlockLands","upgradeLands","userBaseData","userDataSync","visitClearDisaster","visitHome","visitSteal","msgHandler","notifyText","socket","buyProperty","buySeed","detail","duihuan","goBack","hecheng","info","login","main","maskLayer","package","petLayer","register","sell","sellFruit","shop","social","toolbar","visit","warehouse"]);